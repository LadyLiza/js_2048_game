const t=new class{gameStatus={idle:"idle",playing:"playing",win:"win",lose:"lose"};constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=t,this.boardState=this.initialState.map(t=>t.slice()),this.currentStatus=this.gameStatus.idle,this.currentScore=0}moveUp(){if(this.currentStatus===this.gameStatus.playing){let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=0;t<4;t++)0!==this.boardState[t][e]&&s.push(this.boardState[t][e]);for(let e=0;e<s.length;e++)s[e]===s[e+1]&&(s[e]*=2,s[e+1]=0,this.currentScore+=s[e],t=!0);let a=s.filter(t=>0!==t);for(;a.length<4;)a.push(0);for(let s=0;s<4;s++)this.boardState[s][e]!==a[s]&&(this.boardState[s][e]=a[s],t=!0)}t&&(this.addTile(),this.checkStatus())}}moveDown(){if(this.currentStatus===this.gameStatus.playing){let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=3;t>=0;t--)0!==this.boardState[t][e]&&s.push(this.boardState[t][e]);for(let e=0;e<s.length;e++)s[e]===s[e+1]&&(s[e]*=2,s[e+1]=0,this.currentScore+=s[e],t=!0);let a=s.filter(t=>0!==t);for(;a.length<4;)a.push(0);for(let s=0;s<4;s++)this.boardState[s][e]!==a[3-s]&&(this.boardState[s][e]=a[3-s],t=!0)}t&&(this.addTile(),this.checkStatus())}}moveLeft(){if(this.currentStatus===this.gameStatus.playing){let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=0;t<4;t++)0!==this.boardState[e][t]&&s.push(this.boardState[e][t]);for(let e=0;e<s.length;e++)s[e]===s[e+1]&&(s[e]*=2,s[e+1]=0,this.currentScore+=s[e],t=!0);let a=s.filter(t=>0!==t);for(;a.length<4;)a.push(0);for(let s=0;s<4;s++)this.boardState[e][s]!==a[s]&&(this.boardState[e][s]=a[s],t=!0)}t&&(this.addTile(),this.checkStatus())}}moveRight(){if(this.currentStatus===this.gameStatus.playing){let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=3;t>=0;t--)0!==this.boardState[e][t]&&s.push(this.boardState[e][t]);for(let e=0;e<s.length;e++)s[e]===s[e+1]&&(s[e]*=2,s[e+1]=0,this.currentScore+=s[e],t=!0);let a=s.filter(t=>0!==t);for(;a.length<4;)a.push(0);for(let s=0;s<4;s++)this.boardState[e][s]!==a[3-s]&&(this.boardState[e][s]=a[3-s],t=!0)}t&&(this.addTile(),this.checkStatus())}}getScore(){return this.currentScore}getState(){return this.boardState}getStatus(){return this.currentStatus}start(){this.currentStatus=this.gameStatus.playing,this.addTile(),this.addTile()}restart(){this.currentStatus=this.gameStatus.idle,this.boardState=this.initialState.map(t=>t.slice()),this.currentScore=0}addTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.boardState[e][s]&&t.push([e,s]);if(t.length>0){let[e,s]=t[Math.floor(Math.random()*t.length)];this.boardState[e][s]=.9>Math.random()?2:4}}checkStatus(){let t=!1,e=!1;for(let s=0;s<4;s++)for(let a=0;a<4;a++){if(2048===this.boardState[s][a]){this.currentStatus=this.gameStatus.win;return}0===this.boardState[s][a]&&(e=!0),(s<3&&this.boardState[s][a]===this.boardState[s+1][a]||a<3&&this.boardState[s][a]===this.boardState[s][a+1])&&(t=!0)}e||t||(this.currentStatus=this.gameStatus.lose)}},e=document.querySelector(".start"),s=document.querySelector(".message-start"),a=document.querySelector(".message-win"),r=document.querySelector(".message-lose"),i=document.querySelector(".game-field"),o=document.querySelector(".game-score");function l(){o.textContent=t.getScore()}function h(){i.innerHTML="";let e=t.getState();for(let t=0;t<e.length;t++){let s=document.createElement("tr");for(let a=0;a<e[t].length;a++){let r=document.createElement("td"),i=e[t][a];r.textContent=0!==i?i:"",r.classList.add("field-cell"),0!==i&&r.classList.add(`field-cell--${i}`),s.appendChild(r)}i.appendChild(s)}}e.addEventListener("click",()=>{"Start"===e.textContent?(t.start(),s.classList.add("hidden"),e.classList.remove("start"),e.textContent="Restart",e.classList.add("restart")):"Restart"===e.textContent&&(t.restart(),a.classList.add("hidden"),r.classList.add("hidden"),e.textContent="Start",e.classList.add("start"),e.classList.remove("restart"),s.classList.remove("hidden")),h(),l()}),document.addEventListener("keydown",function(e){switch(e.key){case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight()}h(),l(),t.getStatus()===t.gameStatus.win&&a.classList.remove("hidden"),t.getStatus()===t.gameStatus.lose&&r.classList.remove("hidden")});
//# sourceMappingURL=index.f18a68c2.js.map
